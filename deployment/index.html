<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Deployment - Maxwell's Daemon</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">
        <link href="../maxwell.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">Maxwell's Daemon</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../quickstart/" class="nav-link">Quick Start</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Configuration <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../config/" class="dropdown-item">Reference</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Deployment</a>
</li>
                                    
<li>
    <a href="../producers/" class="dropdown-item">Producers</a>
</li>
                                    
<li>
    <a href="../filtering/" class="dropdown-item">Filtering</a>
</li>
                                    
<li>
    <a href="../bootstrapping/" class="dropdown-item">Bootstrapping</a>
</li>
                                    
<li>
    <a href="../dataformat/" class="dropdown-item">Data Format</a>
</li>
                                    
<li>
    <a href="../encryption/" class="dropdown-item">Encryption</a>
</li>
                                    
<li>
    <a href="../monitoring/" class="dropdown-item">Monitoring</a>
</li>
                                    
<li>
    <a href="../high_availability/" class="dropdown-item">High Availability</a>
</li>
                                    
<li>
    <a href="../embedding/" class="dropdown-item">Embedding</a>
</li>
                                    
<li>
    <a href="../schemas/" class="dropdown-item">Internals</a>
</li>
                                    
<li>
    <a href="../compat/" class="dropdown-item">Compatibility</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../changelog/" class="nav-link">Changelog</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../config/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../producers/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
<div class="col-md-3">
<div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#reconfiguring-a-running-mysql-instance" class="nav-link">Reconfiguring a running mysql instance:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#gtid-support" class="nav-link">GTID support</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#rds" class="nav-link">RDS</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#replicating-and-storing-schema-from-different-servers" class="nav-link">Replicating and storing schema from different servers</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#multiple-maxwells" class="nav-link">Multiple Maxwells</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#-init_position" class="nav-link">--init_position</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#running-with-limited-permissions" class="nav-link">Running with limited permissions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div>
</div>
<div class="col-md-9" role="main">
    <div id="Deployment">
        

<h1 id="reconfiguring-a-running-mysql-instance">Reconfiguring a running mysql instance:</h1>
<pre><code>mysql&gt; set global binlog_format=ROW;
mysql&gt; set global binlog_row_image=FULL;
</code></pre>
<p>note: <code>binlog_format</code> is a session-based property.  You will need to shutdown all active connections to fully convert
to row-based replication.</p>
<h1 id="gtid-support">GTID support</h1>
<p>Maxwell contains support for
<a href="https://dev.mysql.com/doc/refman/5.6/en/replication-gtids.html">GTID-based replication</a>.
Enable it with the <code>--gtid_mode</code> configuration param.</p>
<p>Here's how you might configure your mysql server for GTID mode:</p>
<pre><code>$ vi my.cnf

[mysqld]
server_id=1
log-bin=master
binlog_format=row
gtid-mode=ON
log-slave-updates=ON
enforce-gtid-consistency=true
</code></pre>
<p>When in GTID-mode, Maxwell will transparently pick up a new replication
position after a master change.  Note that you will still have to re-point
maxwell to the new master (or use a floating VIP)</p>
<h1 id="rds">RDS</h1>
<p>To run Maxwell against RDS, (either Aurora or Mysql) you will need to do the following:</p>
<ul>
<li>set binlog_format to "ROW".  Do this in the "parameter groups" section.  For a Mysql-RDS instance this parameter will be
  in a "DB Parameter Group", for Aurora it will be in a "DB Cluster Parameter Group".</li>
<li>setup RDS binlog retention as described <a href="http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_LogAccess.Concepts.MySQL.html">here</a>.
  The tl;dr is to execute <code>call mysql.rds_set_configuration('binlog retention hours', 24)</code> on the server.</li>
</ul>
<h1 id="replicating-and-storing-schema-from-different-servers">Replicating and storing schema from different servers</h1>
<p>Maxwell uses MySQL for 3 different functions:</p>
<ol>
<li>A host to store the captured schema in (<code>--host</code>).</li>
<li>A host to replicate binlogs from (<code>--replication_host</code>).</li>
<li>A host to capture the schema from (<code>--schema_host</code>).</li>
</ol>
<p>Often, all three hosts are the same.  <code>host</code> and <code>replication_host</code> should be different
if maxwell is chained off a replica.  <code>schema_host</code> should only be used when using the
maxscale replication proxy.</p>
<h1 id="multiple-maxwells">Multiple Maxwells</h1>
<p>Maxwell can operate with multiple instances running against a single master, in
different configurations.  This can be useful if you wish to have producers
running in different configurations, for example producing different groups of
tables to different topics.  Each instance of Maxwell must be configured with a
unique <code>client_id</code>, in order to store unique binlog positions.</p>
<p>With MySQL 5.5 and below, each replicator (be it mysql, maxwell, whatever) must
also be configured with a unique <code>replica_server_id</code>.  This is a 32-bit integer
that corresponds to mysql's <code>server_id</code> parameter.  The value you configure
should be unique across all mysql and maxwell instances.</p>
<h1 id="-init_position"><code>--init_position</code></h1>
<p>This is a dangerous option that you really shouldn't use unless you know what
you're doing.  It allows you to "rewind" history and go back to a certain point
in the binlog.  This can work, but you should be aware that Maxwell must have
already "visited" that binlog position; simply specifying an arbitrary position
in the binlog will lead to Maxwell crashing. </p>
<h1 id="running-with-limited-permissions">Running with limited permissions</h1>
<p>If the user you're running maxwell as can't view part of the database because of limited
permissions, Maxwell may be unable to capture information on part of the schem a and 
the replication stream can break with "Can't find table: XXX" errors.  In this case
you can enable the <code>ignore_missing_schema</code> flag <em>and</em> configure a filter that will exclude
any databases/tables you don't have permission to view. </p>
    </div>
</div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
